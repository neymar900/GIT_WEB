<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>POS - Restaurante Familiar</title>

<style>
:root{
  --accent:#e85a13;
  --accent-soft:rgba(232,90,19,.12);
  --card:rgba(255,255,255,.90);
  --panel:rgba(255,255,255,.85);
  --text:#1f2937;
}

/* ================= BASE ================= */
html,body{
  margin:0;
  min-height:100%;
}

body{
  font-family: "Segoe UI", Arial, sans-serif;
  color:var(--text);

  /* üî• FONDO REAL VISIBLE */
  background:
    linear-gradient(
      rgba(0,0,0,.35),
      rgba(0,0,0,.35)
    ),
    url("Imagenes/fondoWEB.avif");

  background-size:cover;
  background-position:center;
  background-attachment:fixed;
}

/* ================= LAYOUT ================= */
.container{
  max-width:1200px;
  margin:30px auto;
  padding:0 16px;
}

/* ================= HEADER ================= */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:18px;
}

.brand{
  font-size:24px;
  font-weight:800;
  color:#ff7a1a;
}

.config-btn{
  background:rgba(255,255,255,.85);
  border:0;
  padding:8px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

/* ================= PANELS ================= */
.panel{
  background:var(--panel);
  backdrop-filter: blur(6px);
  border-radius:16px;
  padding:14px;
  margin-bottom:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}

/* ================= FILTERS ================= */
.controls{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.controls input,
.controls select{
  padding:10px;
  border-radius:10px;
  border:1px solid #e5e7eb;
}

.controls button{
  background:#e5e7eb;
  border:0;
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

/* ================= GRID ================= */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}

/* ================= CARD ================= */
.card{
  background:var(--card);
  backdrop-filter: blur(8px);
  border-radius:18px;
  padding:12px;
  box-shadow:0 15px 40px rgba(0,0,0,.35);
  display:flex;
  flex-direction:column;
  gap:10px;
  transition:.15s;
}

.card:hover{
  transform:translateY(-8px);
}

.card img{
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:14px;
}

.title{
  font-weight:800;
  font-size:16px;
}

.cat{
  background:var(--accent-soft);
  color:var(--accent);
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  width:max-content;
}

.price{
  font-size:18px;
  font-weight:800;
  color:var(--accent);
}

/* ================= ACTIONS ================= */
.actions{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
}

.actions input{
  width:80px;
  padding:8px;
  border-radius:8px;
  border:1px solid #e5e7eb;
}

.btn{
  background:var(--accent);
  color:#fff;
  border:0;
  padding:9px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
}

/* ================= TOAST ================= */
.toast{
  position:fixed;
  right:20px;
  bottom:20px;
  background:#111;
  color:#fff;
  padding:10px 14px;
  border-radius:10px;
  display:none;
  z-index:9999;
}
</style>
</head>

<body>
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="brand">üçΩ POS ‚Äì Restaurante Familiar</div>
    <button id="btnConfig" class="config-btn">‚öô Configuraci√≥n</button>
  </div>

  <!-- FILTROS -->
  <div class="panel">
    <div class="controls">
      <input id="search" placeholder="Buscar producto‚Ä¶">
      <select id="filtrocategoria"><option value="">Todas</option></select>
      <select id="metrica">
        <option value="precio">Ordenar por precio</option>
        <option value="nombre">Ordenar por nombre</option>
      </select>
      <button id="btnRefrescar">Actualizar</button>
    </div>
  </div>

  <!-- PRODUCTOS -->
  <div id="grid" class="grid"></div>

</div>

<div id="toast" class="toast"></div>

<script>
const $=id=>document.getElementById(id);
let API_URL=localStorage.getItem("api_url_rest")||"";
let MENU=[];

const IMAGE_MAP={
  chicharron:"chicharron.jpg",
  escabeche:"escabeche.jpg",
  chorizo:"chorizo.jpg",
  fricase:"fricase.webp",
  chichadoble:"chicha.jpg",
  chichalata:"chicha.jpg",
  chichabalde:"chicha.jpg",
  chichaalojadoble:"chichaMorada.webp",
  chichaalojalata:"chichaMorada.webp",
  chichaalojabalde:"chichaMorada.webp",
  cervezaunidad:"cerveza.jpg",
  refresco2l:"Refresco2L.webp",
  refresco3l:"3L.webp"
};

const norm=s=>s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"");

function imgFor(i){
  if(i.imagen) return "Imagenes/"+i.imagen;
  return "Imagenes/"+(IMAGE_MAP[norm(i.nombre)]||"fondoWEB.avif");
}

async function loadMenu(){
  const r=await fetch(API_URL+"?action=menu");
  const d=await r.json();
  MENU=d.map(i=>({
    id:i.id,
    nombre:i.nombre,
    precio:+(i.precio||i.precio_venta),
    categoria:i.categoria,
    imagen:i.imagen||""
  }));
  render();
}

function render(){
  $("grid").innerHTML=MENU.map(i=>`
    <div class="card">
      <img src="${imgFor(i)}">
      <div class="title">${i.nombre}</div>
      <div class="cat">${i.categoria}</div>
      <div class="price">Bs ${i.precio.toFixed(2)}</div>
      <div class="actions">
        <input type="number" value="1">
        <button class="btn">Vender</button>
      </div>
    </div>
  `).join("");
}

if(API_URL) loadMenu();
</script>
</body>
</html>
