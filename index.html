<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>POS ‚Äì Restaurante Familiar</title>

<style>
:root{
  --accent:#e85a13;
  --muted:#6b7280;
  --card:#fff;
}

/* ================= BASE ================= */
html,body{height:100%;margin:0}
body{
  font-family: "Inter","Segoe UI",Arial,sans-serif;
  background:
    linear-gradient(rgba(255,255,255,.78),rgba(255,255,255,.78)),
    url("Imagenes/fondoWEB.avif");
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
  color:#111;
}
.container{max-width:1180px;margin:28px auto;padding:0 14px}

/* ================= HEADER ================= */
.header{display:flex;align-items:center;gap:12px;margin-bottom:14px}
.brand{color:var(--accent);font-weight:800;font-size:22px}
.config-btn{
  margin-left:auto;
  background:#e7eef3;
  color:#333;
  border-radius:10px;
  padding:8px 12px;
  cursor:pointer;
  border:0;
}

/* ================= PANELS ================= */
.panel,.section{
  background:rgba(255,255,255,.95);
  padding:14px;
  border-radius:14px;
  box-shadow:0 10px 26px rgba(0,0,0,.08);
  margin-bottom:18px;
}
.controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

input,select{
  padding:9px;
  border-radius:8px;
  border:1px solid #e6e9ee
}

button,.btn{
  background:var(--accent);
  color:#fff;
  border:0;
  padding:9px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700
}
.btn.sec{background:#cfd6df;color:#111}

/* ================= GRID ================= */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
.card{
  background:var(--card);
  border-radius:14px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  box-shadow:0 12px 28px rgba(0,0,0,.10)
}
.card img{
  width:100%;
  height:140px;
  object-fit:cover;
  border-radius:12px;
  background:#fafafa
}
.title{font-weight:800}
.cat{
  display:inline-block;
  background:#fff5ef;
  color:var(--accent);
  padding:5px 8px;
  border-radius:999px;
  font-size:12px
}
.price{font-weight:800;color:var(--accent)}

.row{display:flex;justify-content:space-between;align-items:center;gap:8px}
.row input[type="number"]{
  width:80px;
  padding:8px;
  border-radius:8px;
  border:1px solid #e6e9ee
}

/* ================= TOAST ================= */
.toast{
  position:fixed;
  right:18px;
  bottom:18px;
  background:#111;
  color:#fff;
  padding:10px 14px;
  border-radius:10px;
  display:none;
  z-index:9999
}

/* ================= MODAL RESULTADO ================= */
.result-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:.2s;
  z-index:12000
}
.result-modal.show{opacity:1;pointer-events:auto}

.result-card{
  background:#fff;
  padding:22px 26px;
  border-radius:16px;
  display:flex;
  align-items:center;
  gap:14px;
  box-shadow:0 25px 70px rgba(0,0,0,.35);
  transform:scale(.9);
  transition:.2s
}
.result-modal.show .result-card{transform:scale(1)}

.result-icon{
  width:54px;
  height:54px;
  border-radius:50%;
  display:grid;
  place-items:center;
  color:#fff;
  font-size:26px;
  font-weight:900
}
.success{background:#16a34a}
.error{background:#ef4444}

/* ================= RESPONSIVE ================= */
@media(max-width:720px){
  .grid{grid-template-columns:1fr}
  .brand{font-size:18px}
}
</style>
</head>

<body>
<div class="container">

<!-- HEADER -->
<div class="header">
  <div class="brand">üçΩ POS ‚Äì Restaurante Familiar</div>
  <button id="btnConfig" class="config-btn">‚öô Configuraci√≥n</button>
</div>

<!-- FILTROS -->
<div class="panel">
  <div class="controls">
    <input id="search" placeholder="Buscar producto...">
    <select id="filtrocategoria"><option value="">Todas</option></select>
    <select id="metrica">
      <option value="precio">Ordenar por precio</option>
      <option value="nombre">Ordenar por nombre</option>
    </select>
    <button id="btnRefrescar" class="btn sec">Actualizar</button>
  </div>
</div>

<!-- PRODUCTOS -->
<div id="grid" class="grid"></div>

<!-- REGISTRO RAPIDO -->
<div class="section">
  <div style="display:flex;gap:10px;flex-wrap:wrap">
    <select id="quickSelect" style="min-width:240px"></select>
    <input id="quickQty" type="number" value="1" min="1">
    <select id="quickPago">
      <option value="efectivo">Efectivo</option>
      <option value="tarjeta">Tarjeta</option>
    </select>
    <button id="quickSell" class="btn">Vender</button>
  </div>
</div>

<!-- REPORTE -->
<div class="section">
  <h3>Reporte</h3>
  <select id="selectDias">
    <option value="7">√öltimos 7 d√≠as</option>
    <option value="30">√öltimos 30 d√≠as</option>
  </select>
  <div id="reportInfo" style="font-weight:800;color:var(--accent);margin-top:8px"></div>
  <div id="reportTable" style="margin-top:8px"></div>
</div>

<!-- CONFIG API -->
<div id="configPanel" class="section" style="display:none">
  <h3>Configuraci√≥n API</h3>
  <input id="apiUrl" style="width:100%" placeholder="Pega tu URL de Apps Script">
  <div style="margin-top:10px;display:flex;gap:8px">
    <button id="guardarApi" class="btn">Guardar</button>
    <button id="probarApi" class="btn sec">Probar</button>
  </div>
</div>

</div>

<!-- TOAST -->
<div id="toast" class="toast"></div>

<!-- MODAL RESULTADO -->
<div id="resultModal" class="result-modal">
  <div class="result-card">
    <div id="resultIcon" class="result-icon success">‚úî</div>
    <div>
      <div id="resultTitle" style="font-weight:800">Venta realizada</div>
      <div id="resultText" style="color:#555">Se registr√≥ correctamente</div>
    </div>
  </div>
</div>

<script>
const $=id=>document.getElementById(id);

let API_URL=localStorage.getItem("api_url_rest")||"";

const MENU=[
{id:1,nombre:"Chicharron",precio:50,categoria:"Comida",imagen:"chicharron.jpg"},
{id:2,nombre:"Escabeche",precio:30,categoria:"Comida",imagen:"escabeche.jpg"},
{id:3,nombre:"Chorizo",precio:20,categoria:"Comida",imagen:"chorizo.jpg"},
{id:4,nombre:"Fricase",precio:30,categoria:"Comida",imagen:"fricase.webp"},
{id:5,nombre:"Chicha doble",precio:6,categoria:"Bebida",imagen:"chicha.jpg"},
{id:6,nombre:"Chicha lata",precio:70,categoria:"Bebida",imagen:"chicha.jpg"},
{id:7,nombre:"Chicha balde",precio:18,categoria:"Bebida",imagen:"chicha.jpg"},
{id:8,nombre:"Chicha aloja doble",precio:8,categoria:"Bebida",imagen:"chichaMorada.webp"},
{id:9,nombre:"Cerveza unidad",precio:15,categoria:"Bebida",imagen:"cerveza.jpg"},
{id:10,nombre:"Refresco 2L",precio:14,categoria:"Bebida",imagen:"Refresco2L.webp"},
{id:11,nombre:"Refresco 3L",precio:20,categoria:"Bebida",imagen:"3L.webp"}
];

function showResult(ok,msg){
  const m=$("resultModal");
  $("resultIcon").className="result-icon "+(ok?"success":"error");
  $("resultIcon").textContent=ok?"‚úî":"‚úñ";
  $("resultTitle").textContent=ok?"Venta registrada":"Error";
  $("resultText").textContent=msg;
  m.classList.add("show");
  setTimeout(()=>m.classList.remove("show"),1800);
}

function render(){
  $("grid").innerHTML=MENU.map(i=>`
  <div class="card">
    <img src="Imagenes/${i.imagen}">
    <div class="title">${i.nombre}</div>
    <div class="cat">${i.categoria}</div>
    <div class="price">Bs ${i.precio}</div>
    <div class="row">
      <input id="q_${i.id}" type="number" value="1" min="1">
      <button onclick="sell(${i.id})">Vender</button>
    </div>
  </div>`).join("");
  $("quickSelect").innerHTML=MENU.map(i=>`<option value="${i.id}">${i.nombre}</option>`).join("");
}

async function sell(id){
  const it=MENU.find(x=>x.id==id);
  const qty=+$("q_"+id).value||1;
  if(!API_URL){showResult(false,"Configura la API");return;}
  try{
    await fetch(API_URL,{method:"POST",body:new URLSearchParams({
      action:"registrar_venta",
      producto_id:it.id,
      producto_nombre:it.nombre,
      cantidad:qty,
      precio_unitario:it.precio,
      total:it.precio*qty
    })});
    showResult(true,"Venta registrada correctamente");
  }catch{showResult(false,"No se pudo conectar");}
}

$("btnConfig").onclick=()=>$("configPanel").style.display=
$("configPanel").style.display==="block"?"none":"block";

$("guardarApi").onclick=()=>{
  API_URL=$("apiUrl").value.trim();
  localStorage.setItem("api_url_rest",API_URL);
  showResult(true,"API guardada");
};

render();
</script>
</body>
</html>
